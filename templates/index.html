<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vitals Summary</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Inter', sans-serif;
      }

      body {
        background: linear-gradient(135deg, #e3f2fd, #ffffff);
        color: #333;
        padding: 30px;
      }

      .container {
        max-width: 1100px;
        margin: auto;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(12px);
        padding: 25px;
        border-radius: 16px;
        box-shadow: 0px 10px 30px rgba(0, 0, 0, 0.1);
      }

      .patient-details {
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
        padding: 20px;
        background: rgba(255, 255, 255, 0.7);
        border-radius: 12px;
        box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.05);
      }

      .tabs {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 25px 0;
      }

      .tabs div {
        background: rgba(0, 123, 255, 0.1);
        padding: 12px 18px;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.3s ease;
      }

      .tabs div.active {
        background: #007BFF;
        color: white;
        box-shadow: 0px 4px 10px rgba(0, 123, 255, 0.3);
      }

      .tabs div:hover {
        background: rgba(0, 123, 255, 0.3);
      }

      .content {
        padding: 20px;
      }

      .table-container {
        background: rgba(255, 255, 255, 0.7);
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.05);
        overflow-x: auto;
        width: 100%;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 12px;
      }

      th,
      td {
        padding: 12px;
        border: 1px solid rgba(0, 0, 0, 0.1);
        text-align: center;
      }

      th {
        background: rgba(0, 123, 255, 0.15);
        font-weight: 600;
      }

      .left-col {
        text-align: left;
        background-color: #f9f9f9;
      }

      button {
        padding: 12px 16px;
        border: none;
        border-radius: 6px;
        background: #007BFF;
        color: white;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      button:hover {
        background: #0056b3;
      }

      input[type="date"] {
        padding: 12px;
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 6px;
        outline: none;
        background: rgba(255, 255, 255, 0.95);
        font-size: 14px;
      }

      @media (max-width: 768px) {
        table,
        th,
        td {
          font-size: 12px;
          padding: 5px;
        }
      }

      .documentation-card {
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(8px);
        padding: 15px;
        border-radius: 12px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.05);
        margin: 15px 0;
      }

      .download-btn {
        display: inline-block;
        background: #007BFF;
        color: white;
        padding: 8px 12px;
        border-radius: 6px;
        text-decoration: none;
        margin-top: 10px;
      }

      .download-btn:hover {
        background: #0056b3;
      }

      .date-info {
        font-size: 12px;
        color: #555;
        margin-top: 10px;
      }

      .back-btn {
        display: inline-block;
        background: #f8f9fa;
        color: #007BFF;
        padding: 10px 15px;
        border-radius: 8px;
        font-weight: 600;
        text-decoration: none;
        transition: all 0.3s ease;
        box-shadow: 0px 3px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }

      .back-btn:hover {
        background: #007BFF;
        color: white;
      }
    </style>
  </head>
  <body>
    <!-- Patient Information Section -->
    <div class="patient-details">
      <div>
        <strong>Patient Name:</strong> {{patient.user.first_name}}
        {{patient.user.last_name}}
      </div>
      <div><strong>DOB:</strong> {{patient.date_of_birth}}</div>
      <div><strong>Sex:</strong> {{patient.sex}}</div>
      <div><strong>Weight:</strong> {{patient.weight}} kg</div>
      <div><strong>Height:</strong> {{patient.height}} cm</div>
      <div><strong>BMI: {{patient.bmi}}</strong></div>
    </div>

    <!-- Tabs for Navigation -->
    <div class="tabs">
      <div class="active" onclick="showTab('results')">Results</div>
      <div onclick="showTab('orders')">Orders</div>
      <div onclick="showTab('documentation')">Documentation</div>
      <div onclick="showTab('allergies')">Allergies</div>
      <div onclick="showTab('ptinfo')">PT Info</div>
      <div onclick="showTab('medications')">Medications</div>
      <div onclick="showTab('pharmacy')">Pharmacy</div>
    </div>

    <!-- Content Section for Tabs -->
    <div class="content">
      <!-- Results Tab -->
      <div id="results" class="table-container">
        <h3>Results</h3>
        <table>
          <thead>
            <tr>
              <th class="left-col">Vital Signs</th>
              {% for report in reports %}
              <th>{{report.created_at}}</th>
              <!-- New column -->
              {% endfor %}
              <th>Additional Info</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="left-col">SpO2 (%)</td>
              
              {% for report in reports %}
              <td>{{report.spo2}}</td>
              {% endfor %}
              <td>Additional details</td>
            </tr>
            <tr>
              <td class="left-col">Blood Pressure</td>
              
              {% for report in reports %}
              <td>{{report.blood_pressure}}</td>
              {% endfor %}
              <td>Additional details</td>
            </tr>
            <tr>
              <td class="left-col">Heart Rate</td>
              
              {% for report in reports %}
              <td>{{report.heart_rate}}</td>
              {% endfor %}
              <td>Additional details</td>
            </tr>
            <tr>
              <td class="left-col">Temperature</td>
              
              {% for report in reports %}
              <td>{{report.temperature}}</td>
              {% endfor %}
              <td>Additional details</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Orders Tab -->
      <div id="orders" class="table-container" style="display: none">
        <h3>Orders</h3>
        <table>
          <thead>
            <tr>
              <th class="left-col">Order</th>
              <th>9/27/2024</th>
              <th>9/27/2024</th>
              <th>9/27/2024</th>
              <th>9/27/2024</th>
              <th>Additional Info</th>
              <!-- New column -->
            </tr>
            <tr>
              <th class="left-col"></th>
              <th>10:37 AM</th>
              <th>11:24 AM</th>
              <th>12:10 PM</th>
              <th>1:32 PM</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="left-col">O2</td>
              <td>Ordered</td>
              <td>Administered</td>
              <td>Discontinued</td>
              <td>---</td>
              <td>Details</td>
            </tr>
            <tr>
              <td class="left-col">Mobility</td>
              <td>Initiated</td>
              <td>On Hold</td>
              <td>---</td>
              <td>Restarted</td>
              <td>Comments</td>
            </tr>
            <tr>
              <td class="left-col">Allergy</td>
              <td>Penicillin</td>
              <td>N/A</td>
              <td>N/A</td>
              <td>Confirmed</td>
              <td>Extra info</td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <!-- Back Button -->
      <a href="/view-patient/" class="back-btn">‚Üê Back to Patient List</a>

      <!-- Documentation Tab -->
      <div id="documentation" class="table-container" style="display: none">
        <h3>Documentation</h3>
        <form id="doc-form">
          <label for="date">Select Date:</label>
          <input type="date" id="date" name="date">
          <button type="button" onclick="fetchDocumentation()">View</button>
        </form>
        <div id="documentation-details">
            {% if documentations %}
                <ul>
                    {% for doc in documentations %}
                        <div class="documentation-card">
                          <h4>{{ doc.title }}</h4>
                          <p>{{ doc.description }}</p>
                          {% if doc.cheif_complaint %}
                              <p><strong>Chief Complaint:</strong> {{ doc.cheif_complaint }}</p>
                          {% endif %}
                          {% if doc.subjective %}
                              <p><strong>Subjective:</strong> {{ doc.subjective }}</p>
                          {% endif %}
                          {% if doc.objective %}
                              <p><strong>Objective:</strong> {{ doc.objective }}</p>
                          {% endif %}
                          {% if doc.assessment %}
                              <p><strong>Assessment:</strong> {{ doc.assessment }}</p>
                          {% endif %}
                          {% if doc.plan %}
                              <p><strong>Plan:</strong> {{ doc.plan }}</p>
                          {% endif %}
                          {% if doc.file.url %}
                              <a href="{{ doc.file.url }}" class="download-btn">Download File</a>
                          {% endif %}
                          <p class="date-info">Created: {{ doc.created_at }} | Updated: {{ doc.updated_at }}</p>
                        </div>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No documentation found for the selected date.</p>
            {% endif %}
        </div>
      </div>

      <!-- Allergies Tab -->
      <div id="allergies" class="table-container" style="display: none">
        <h3>Allergies</h3>
        <!-- Add your content here -->
      </div>

      <!-- PT Info Tab -->
      <div id="ptinfo" class="table-container" style="display: none">
        <h3>PT Info</h3>
        <!-- Add your content here -->
      </div>

      <!-- Medications Tab -->
      <div id="medications" class="table-container" style="display: none">
        <h3>Medications</h3>
        <!-- Add your content here -->
      </div>

      <!-- Pharmacy Tab -->
      <div id="pharmacy" class="table-container" style="display: none">
        <h3>Pharmacy</h3>
        <!-- Add your content here -->
      </div>
    </div>

    <script>
      function showTab(tabId) {
        const tabs = document.querySelectorAll(".table-container");
        const tabButtons = document.querySelectorAll(".tabs div");

        tabs.forEach((tab) => (tab.style.display = "none"));
        tabButtons.forEach((button) => button.classList.remove("active"));

        document.getElementById(tabId).style.display = "block";
        event.target.classList.add("active");
      }

      function fetchDocumentation() {
        const date = document.getElementById("date").value;
        if (!date) {
          alert("Please select a date");
          return;
        }

        fetch(`/view_documentation/?date=${date}`)
          .then(response => response.json())
          .then(data => {
            const docContainer = document.getElementById("documentation-details");
            if (data.length === 0) {
              docContainer.innerHTML = "<p>No documentation found for the selected date.</p>";
            } else {
              let content = "";
              data.forEach(doc => {
                content += `
                  <div class="documentation-card">
                    <h4>${doc.title}</h4>
                    <p>${doc.description}</p>
                    ${doc.cheif_complaint ? `<p><strong>Chief Complaint:</strong> ${doc.cheif_complaint}</p>` : ""}
                    ${doc.subjective ? `<p><strong>Subjective:</strong> ${doc.subjective}</p>` : ""}
                    ${doc.objective ? `<p><strong>Objective:</strong> ${doc.objective}</p>` : ""}
                    ${doc.assessment ? `<p><strong>Assessment:</strong> ${doc.assessment}</p>` : ""}
                    ${doc.plan ? `<p><strong>Plan:</strong> ${doc.plan}</p>` : ""}
                    ${doc.file_url ? `<a href="${doc.file_url}" target="_blank" class="download-btn">Download File</a>` : ""}
                    <p class="date-info">Created: ${doc.created_at} | Updated: ${doc.updated_at}</p>
                  </div>
                `;
              });
              docContainer.innerHTML = content;
            }
          })
          .catch(error => console.error("Error fetching documentation:", error));
      }
    </script>
  </body>
</html>
